clc;
clear;
initConds = [];
%===========The TPN system of my work as shown in Eg. 3, it is diagnosable
M0 = [0 0 0 1 0 0]';
TPN.Pre= [[0 1 0 0 0 0]' [0;0;1;0;0;0] [1;0;0;0;0;0] [0;0;0;1;0;0]  [0;0;0;1;0;0] [0;0;0;0;1;0] [0;0;0;0;0;1]];
TPN.Post=[[0;0;1;0;0;0] [1;0;0;0;0;0] [0;1;0;0;0;0] [1;0;1;0;0;0]  [0;0;0;0;1;0] [0;0;0;0;0;1] [0;0;0;0;1;0]];
TPN.Intervals=[[3,7]'  [2,8]' [3,9]' [4,8]' [3,7]' [6,8]' [7,8]']; 
TPN.Labels={'a','b','eps','eps','eps','b','a'};
TPN.Tf=[4];%t4 is faulty while the others are normal

%---TheTPN system shown in Eg. 4, not diagnosable:------------------------------
% M0 = [0 0 0 1 0 0]';
% TPN.Pre= [[0 1 0 0 0 0]' [0;0;1;0;0;0] [1;0;0;0;0;0] [0;0;0;1;0;0]  [0;0;0;1;0;0] [0;0;0;0;1;0] [0;0;0;0;0;1]];
% TPN.Post=[[0;0;1;0;0;0] [1;0;0;0;0;0] [0;1;0;0;0;0] [1;0;1;0;0;0]  [0;0;0;0;1;0] [0;0;0;0;0;1] [0;0;0;0;1;0]];
% TPN.Intervals=[[3,7]'  [2,8]' [3,9]' [4,8]' [3,7]' [2,12]' [6,11]'];  
% TPN.Labels={'a','b','eps','eps','eps','b','a'};
% TPN.Tf=[4];

%======The TPN system given in Basile 2017=================================
% M0 = [1 0 0 0 0]';
% TPN.Pre= [[0 1 0 0 0]' [0;0;1;0;0] [0;0;0;0;1] [1;0;0;0;0]  [1;0;0;0;0] [0;0;1;0;0] [0;0;0;1;0]];
% TPN.Post=[[0;0;1;0;0]  [1;0;0;0;0] [1;0;0;0;0] [0;1;0;0;0]  [0;0;1;0;0] [0;0;0;1;0] [0;0;0;0;1]];
% TPN.Intervals=[[1,2]'  [1,2]' [1,2]' [2,2]' [1,2]' [0,2]' [1,1]'];  
% TPN.Labels={'a','b','b','eps','eps','eps','eps'};
% TPN.Tf=[5];   % T_f^1 logically diagnosable
% %--------------------------------------------------------------------------
% M0 = [1 0 0 0 0]';
% TPN.Pre= [[0 1 0 0 0]' [0;0;1;0;0] [0;0;0;0;1] [1;0;0;0;0]  [1;0;0;0;0] [0;0;1;0;0] [0;0;0;1;0]];
% TPN.Post=[[0;0;1;0;0]  [1;0;0;0;0] [1;0;0;0;0] [0;1;0;0;0]  [0;0;1;0;0] [0;0;0;1;0] [0;0;0;0;1]];
% TPN.Intervals=[[1,2]'  [1,2]' [1,2]' [2,2]' [1,2]' [0,2]' [1,1]'];  
% TPN.Labels={'a','b','b','eps','eps','eps','eps'};
% TPN.Tf=[7];     % T_f^2 %not diagnosable: {[1]}    {1×1 cell}    {[5 2]}    {[5 6 7 3]}    {[1]}

%=========================================================================
% this procedure will output an counter example if it is not diagnosable

% [All_SP, Edge]=T_diag(M0,TPN);
[All_SP, Edge,node_0]=Compute_SPCG(M0,TPN);

% the reslut of Eg.4:
% it means state pair class All_SP{1}--(t5 t6, t4 t2)-->All_SP{2}
%     {[1]}    {1×1 cell}    {[5 6]}  {[4 2]}    {[2]}
%     {[2]}    {1×1 cell}    {[7]}    {[3 1]}    {[5]}
%     {[5]}    {1×1 cell}    {[6]}    {[2]}    {[9]}
%     {[9]}    {1×1 cell}    {[7]}    {[3 1]}    {[5]}
% it means a sequence of state pair classes:
% All_SP{1}->All_SP{2}->All_SP{5}->All_SP{9}->All_SP{5}

